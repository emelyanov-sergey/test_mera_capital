# Проект: Приложение для получения и хранения цен криптовалютных индексов

## Обзор
Этот проект представляет собой приложение на базе FastAPI, которое взаимодействует с API Deribit для получения цен на криптовалютные индексы BTC и ETH. Приложение сохраняет эти цены в базе данных PostgreSQL, используя SQLAlchemy для ORM и APScheduler для планирования периодических задач. Проект структурирован на несколько модулей, каждый из которых отвечает за различные аспекты приложения.

## Структура проекта

- **`backend/main.py`**: Точка входа в приложение. Инициализирует FastAPI, настраивает базу данных и планирует периодические задачи.
- **`backend/core/routers.py`**: Содержит API-маршруты для взаимодействия с сохраненными данными.
- **`backend/core/db_connection.py`**: Управляет подключением к базе данных и созданием сессий.
- **`backend/deribit_client.py`**: Обрабатывает получение цен индексов из API Deribit и их сохранение в базе данных.
- **`backend/core/db_model.py`**: Определяет модели и схемы базы данных.


## Установка

### 1. Клонирование репозитория
Склонируйте проект:
```sh
git clone git@github.com:emelyanov-sergey/test_mera_capital.git
cd test_mera_capital
```

### 2. Создайте .env файл
Создайте файл .env в корневой директории проекта и добавьте в него следующие строки для тестового запуска проекта:
```sh
POSTGRES_HOST=db
POSTGRES_DB=mera_capital
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_PORT=5432
```

### 3. Настройте переменные окружения для подключения к базе данных:
Убедитесь, что в файле backend/core/config.py указаны правильные параметры подключения к вашей базе данных PostgreSQL.

### 4. Запуск приложения
Запустите команду в терминале из корневой директории проекта:
```sh
docker-compose up --build
```


## Доступ к API:
После запуска приложение будет доступно по адресу [http://127.0.0.1:8000](http://127.0.0.1:8000/docs#/). Вы можете использовать инструменты, такие как Postman или curl, для взаимодействия с API.
## Основные эндпоинты
- GET /all_prices/{ticker}: Возвращает все сохраненные данные по указанной валюте (BTC или ETH).
- GET /latest-price/{ticker}: Возвращает последнюю цену валюты.
- GET /prices/{ticker}: Возвращает цену валюты с фильтром по дате.

## Логирование
Логирование настроено в файле backend/core/logger.py и выводит информацию как в файл app.log, так и в консоль.
